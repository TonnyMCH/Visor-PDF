<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bingo con CÃ¡mara</title>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>

<style>
body{
  margin:0;
  font-family:system-ui, sans-serif;
  background:#0f172a;
  color:#e5e7eb;
}
header{
  padding:12px;
  text-align:center;
  background:#020617;
  font-size:18px;
  font-weight:600;
}
.container{ padding:10px; }
.controls{
  display:flex;
  gap:6px;
  flex-wrap:wrap;
  margin-bottom:10px;
}
input{
  flex:1;
  padding:10px;
  font-size:18px;
  border-radius:10px;
  border:none;
}
button{
  padding:10px;
  border:none;
  border-radius:10px;
  font-weight:600;
}
.marcar{ background:#22c55e; }
.cam{ background:#facc15; }
.des{ background:#38bdf8; }
.clear{ background:#ef4444; }

video{
  width:100%;
  border-radius:14px;
  margin-bottom:8px;
}

.carton{
  background:#020617;
  border-radius:14px;
  padding:10px;
  margin-bottom:12px;
}
.grid{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:6px;
}
.cell{
  background:#1e293b;
  border-radius:8px;
  padding:10px 0;
  text-align:center;
  font-size:16px;
}
.cell.marked{
  background:#22c55e;
  color:#052e16;
  font-weight:700;
}
</style>
</head>

<body>
<header>ðŸ“· Bingo con cÃ¡mara (4 cartones)</header>

<div class="container">
  <div class="controls">
    <input id="num" placeholder="NÃºmero detectado">
    <button class="marcar" onclick="marcar()">Marcar</button>
    <button class="cam" onclick="capturar()">ðŸ“· CÃ¡mara</button>
    <button class="des" onclick="desmarcar()">Desmarcar</button>
    <button class="clear" onclick="limpiar()">Limpiar</button>
  </div>

  <video id="video" autoplay playsinline></video>
  <canvas id="canvas" hidden></canvas>

  <div id="cartones"></div>
</div>

<script>
const cartonesDiv = document.getElementById("cartones");

// crear 4 cartones
for(let c=1;c<=4;c++){
  const d=document.createElement("div");
  d.className="carton";
  d.innerHTML=`<h3>CartÃ³n ${c}</h3><div class='grid'></div>`;
  const g=d.querySelector(".grid");
  for(let i=0;i<25;i++){
    const cell=document.createElement("div");
    cell.className="cell";
    cell.contentEditable=true;
    cell.onclick=()=>cell.classList.toggle("marked");
    g.appendChild(cell);
  }
  cartonesDiv.appendChild(d);
}

// cÃ¡mara
const video=document.getElementById("video");
navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}})
.then(s=>video.srcObject=s);

// marcar nÃºmero
function marcar(){
  const n=document.getElementById("num").value.trim();
  if(!n) return;
  document.querySelectorAll(".cell").forEach(c=>{
    if(c.innerText.trim()===n) c.classList.add("marked");
  });
  document.getElementById("num").value="";
}

// OCR
async function capturar(){
  const canvas=document.getElementById("canvas");
  canvas.width=video.videoWidth;
  canvas.height=video.videoHeight;
  canvas.getContext("2d").drawImage(video,0,0);

  const r=await Tesseract.recognize(canvas,"eng");
  const nums=r.data.text.match(/\b\d{1,2}\b/g);
  if(nums){
    nums.forEach(n=>{
      document.getElementById("num").value=n;
      marcar();
    });
  }else alert("No se detectÃ³ nÃºmero");
}

function desmarcar(){
  document.querySelectorAll(".cell").forEach(c=>c.classList.remove("marked"));
}
function limpiar(){
  if(confirm("Â¿Borrar todo?")){
    document.querySelectorAll(".cell").forEach(c=>{
      c.classList.remove("marked");
      c.innerText="";
    });
  }
}
</script>
</body>
</html>
